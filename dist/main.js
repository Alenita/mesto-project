!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){class n{constructor(e,t,n){this.id=n,console.log(this.id),this.cardElement=this.createCard(e,t,n),this.remove=this.remove.bind(this),this.cardElement.querySelector(".place-card__like-icon").addEventListener("click",this.like),this.cardElement.querySelector(".place-card__delete-icon").addEventListener("click",this.remove)}createCard(e,t){const n=document.createElement("div"),o=document.createElement("div"),r=document.createElement("button"),a=document.createElement("div"),c=document.createElement("h3"),i=document.createElement("div"),s=document.createElement("button"),l=document.createElement("p");return n.classList.add("place-card"),o.classList.add("place-card__image"),o.style.backgroundImage="url("+t+")",r.classList.add("place-card__delete-icon"),a.classList.add("place-card__description"),c.classList.add("place-card__name"),c.textContent=e,i.classList.add("place-card__like-container"),s.classList.add("place-card__like-icon"),l.classList.add("place-card__like-amount"),n.appendChild(o),o.appendChild(r),n.appendChild(a),a.appendChild(c),a.appendChild(i),i.appendChild(s),i.appendChild(l),n}addLikes(e,t){e.querySelector(".place-card__like-amount").textContent=t}like(e){e.target.classList.toggle("place-card__like-icon_liked")}remove(){o.deleteMyCard(this.id)}}const o=new class{constructor(e){this.url=e.baseUrl,this.key=e.headers.authorization}getInfo(){return fetch(this.url+"/users/me",{method:"GET",headers:{authorization:this.key}}).then(e=>e.json()).then(e=>{!function(e){document.querySelector(".user-info__name").textContent=e.name,document.querySelector(".user-info__photo").backgroundImage=`url(${e.avatar})`,document.querySelector(".user-info__job").textContent=e.about,g(e.name,e.about)}(e),console.log(e)}).catch(()=>{console.log("Что-то пошло не так при передаче данных")})}getInitialCards(){return fetch(this.url+"/cards",{method:"GET",headers:{authorization:this.key}}).then(e=>e.json()).then(e=>{!function(e){e.forEach((function(e){_.addCard(e.name,e.link,e.likes.length,e._id)}))}(e)})}changeInfo(e,t){return fetch(this.url+"/users/me",{method:"PATCH",headers:{authorization:this.key,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then(e=>e.json()).then(e=>{console.log(e)}).catch(()=>{console.log("Что-то пошло не так при обновлении данных")})}addNewCard(e,t){return fetch(this.url+"/cards",{method:"POST",headers:{authorization:this.key,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then(e=>e.json()).then(e=>{console.log(e),_.addCard(e.name,e.link)}).catch(()=>{console.log("Что-то пошло не так при добавлении карточки")})}deleteMyCard(e){return fetch(this.url+"/cards/"+e,{method:"DELETE",headers:{authorization:this.key}}).then(e=>e.json())}}({baseUrl:"http://95.216.175.5/cohort4",headers:{authorization:"e31b8201-6546-4dbc-95b4-55518f77f3d1","Content-Type":"application/json"}});o.getInfo(),o.getInitialCards();class r{constructor(e){this.popup=e,this.popup.querySelector(".popup__close").addEventListener("click",this.close)}close(e){e.target.closest(".popup").classList.remove("popup_is-opened")}open(){this.popup.classList.add("popup_is-opened")}}const a=document.querySelector(".user-info__name"),c=document.querySelector(".user-info__job"),i=document.querySelector(".places-list"),s=document.querySelector(".popup"),l=document.querySelector("#card-button"),d=document.forms.new,u=document.querySelector(".popup-edit"),p=document.querySelector("#edit-button"),m=document.forms.about,h=m.elements.naming,f=m.elements.info,_=new class{constructor(e){this.container=e,this.array=[]}render(e){this.container.appendChild(e)}addCard(e,t,o,r){const a=new n(e,t,r);this.array.push(a.cardElement),this.render(a.cardElement),a.addLikes(a.cardElement,o)}}(document.querySelector(".places-list")),y=new r(document.querySelector(".popup")),v=new r(document.querySelector(".popup-edit")),b=new r(document.querySelector(".popup-img"));function g(e,t){h.value=e,f.value=t,p.removeAttribute("disabled"),p.classList.add("popup__button_active")}function S(e){("link"===e.target.name?k:L)(e.target)}function E(e){e.preventDefault();const t=Array.from(e.target.closest(".form").elements);let n=!0;t.forEach((function(t){t.querySelector("[type = submit]")||t.checkValidity()||(n=!1,e.target.closest(".form").querySelector(".button").setAttribute("disabled",!0),e.target.closest(".form").querySelector(".button").classList.remove("popup__button_active"))})),n&&(e.target.closest(".form").querySelector(".button").removeAttribute("disabled"),e.target.closest(".form").querySelector(".button").classList.add("popup__button_active"))}function L(e){let t=document.querySelector(`#error-${e.id}`);t="",(e.validity.tooShort||e.validity.tooLong)&&(t="Должно быть от 2 до 30 символов"),e.validity.valueMissing&&(t="Это обязательное поле"),e.nextElementSibling.textContent=t}function k(e){let t=document.querySelector(`#error-${e.id}`);t="",e.validity.valueMissing&&(t="Это обязательное поле"),e.validity.typeMismatch&&(t="Здесь должна быть ссылка"),e.nextElementSibling.textContent=t}document.querySelector(".user-info__button").addEventListener("click",(function(){y.open()})),document.querySelector(".edit__button").addEventListener("click",(function(){v.open()})),i.addEventListener("click",(function(e){if(e.target.classList.contains("place-card__image")){const t=document.querySelector(".popup__image");let n=e.target.getAttribute("style").slice(23,-3);t.src=`${n}`,b.open()}})),d.addEventListener("submit",(function(e){l.classList.contains("popup__button_active")&&(e.preventDefault(),o.addNewCard(d.elements.name.value,d.elements.link.value),s.classList.remove("popup_is-opened"),d.reset())})),p.addEventListener("click",(function(e){p.classList.contains("popup__button_active")&&(e.preventDefault(),a.textContent=h.value,c.textContent=f.value,u.classList.remove("popup_is-opened"),o.changeInfo(h.value,f.value))})),s.addEventListener("input",S),m.addEventListener("input",S),m.addEventListener("input",E),s.addEventListener("input",E),g()}]);